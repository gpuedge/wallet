<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>👛</text></svg>">

    <meta name="description" content="GPUx - Wallet" />
    <meta charset="utf-8">
    <title>Wallet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
     
    <script src="https://unpkg.com/htm@2.2.1/dist/htm.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react@17.0.1/umd/react.production.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react-dom@17.0.1/umd/react-dom.production.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/deepmerge@4.2.2/dist/umd.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tweetnacl/1.0.3/nacl-fast.min.js" crossorigin="anonymous"></script>

    <!-- Google font file. If you want you can change. -->
    <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,900" rel="stylesheet">

    <!-- Fontawesome font file css -->
    <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">

    <!-- Animate css file for css3 animations. for more : https://daneden.github.io/animate.css -->
    <!-- Only use animate action. If you dont use animation, you don't have to add.-->
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/cryptocoins.css">
    <!-- <link rel="stylesheet" type="text/css" href="plugins/c3-chart/c3.css"> -->

    <!-- Swiper slider css file -->
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" href="css/jqcandlestick.css">

    <!--turbo slider plugin css file -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="plugins/turbo-slider/turbo.css">

    <!-- Template global css file. Requared all pages -->
    <link rel="stylesheet" type="text/css" href="css/global.style.css">

    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="plugins/turbo-slider/turbo.min.js"></script>
    <script src="js/global.script.js"></script>

    <style>
    </style>
  </head>
  <body>

    <div id="app"></div>

    <script type="module">
      import { setInitialState, buildInitialState, wireUpGlobalState, setGlobalState, globalState } from "./state.js"
      const { createElement, useState, useEffect, useRef } = React;
      const html = htm.bind(createElement);

      function MenuSide() {
        return html`
        <div class="nav-menu">
          <nav class="menu">
            <!-- Menu navigation start -->
            <div class="nav-container">
              <ul class="main-menu">
                <li class="active">
                  <a href="index.html"><img src="img/content/icons/1.png" alt="" /><strong class="special">Dashboard</strong> </a>
                </li>
                <li class="">
                  <a href="wallet.html"><img src="img/content/icons/2.png" alt="" /><strong class="special">My Walet</strong> </a>
                </li>
                <li class="">
                  <a href="trading.html"><img src="img/content/icons/3.png" alt="" /><strong class="special">Crypto Trade</strong> </a>
                </li>
                <li class="">
                  <a href="buy-sell.html"><img src="img/content/icons/6.png" alt="" /><strong class="special">Buy & sell</strong> </a>
                </li>
                <li class="">
                  <a href="profile.html"><img src="img/content/icons/5.png" alt="" /><strong class="special">Trader Profile</strong> </a>
                </li>
                <li class="">
                  <a href="affiliate.html"><img src="img/content/icons/4.png" alt="" /><strong class="special">Affiliate System</strong> </a>
                </li>
                <li class="">
                  <a href="setting.html"><img src="img/content/icons/11.png" alt="" /><strong class="special">Settings</strong> </a>
                </li>
                <li>
                  <a href="javascript:void(0);"><img src="img/content/icons/9.png" alt="" /><strong class="special">Login/Register</strong> <span class="fa fa-angle-down"></span></a>
                  <ul>
                    <li><a href="login.html" data-loader="show">Login</a></li>
                    <li><a href="signup.html" data-loader="show">Register</a></li>
                    <li><a href="forgot-password.html" data-loader="show">Forgot Password</a></li>
                  </ul>
                </li>
                <li>
                  <a href="javascript:void(0);"><img src="img/content/icons/8.png" alt="" /> <strong class="special">Wizards</strong> <span class="fa fa-angle-down"></span></a>
                  <ul>
                    <li><a href="wizard-default.html" data-loader="show">Wizard Default</a></li>
                    <li><a href="wizard-fullscreen.html" data-loader="show">Wizard Fullscreen</a></li>
                  </ul>
                </li>
                <li class="">
                  <a href="charts.html"><img src="img/content/icons/14.png" alt="" /><strong class="special">Charts</strong> </a>
                </li>
                <li>
                  <a href="forms.html" data-loader="show"><img src="img/content/icons/7.png" alt="" /><strong class="special">Form Elements</strong></a>
                </li>
                <li>
                  <a href="#"><img src="img/content/icons/10.png" alt="" /><strong class="special"> Components</strong> <span class="fa fa-angle-down"></span></a>
                  <ul>
                    <li><a href="tab-bottom.html" data-loader="show">Tab (Bottom)</a></li>
                    <li><a href="tab-top.html" data-loader="show">Tab (Top)</a></li>
                    <li><a href="accordion.html" data-loader="show">Accordion</a></li>
                    <li><a href="popup.html" data-loader="show">Popup Modal</a></li>
                    <li><a href="checkbox-list.html" data-loader="show">Check List</a></li>
                    <li><a href="link-list.html" data-loader="show">Link List</a></li>
                    <li><a href="link-list-two-column.html" data-loader="show">Two Column Links</a></li>
                  </ul>
                </li>
                <li class="">
                  <a href="#"><img src="img/content/icons/15.png" alt="" /><strong class="special"> Pages</strong> <span class="fa fa-angle-down"></span></a>
                  <ul>
                    <li class=""><a href="profile.html" data-loader="show">User Profile</a></li>
                    <li><a href="search-result.html" data-loader="show">Search Results</a></li>
                    <li><a href="contact.html" data-loader="show">Contact</a></li>
                    <li><a href="blank.html" data-loader="show">Blank Page</a></li>
                  </ul>
                </li>
              </ul>
            </div>
            <!-- Menu navigation end -->
          </nav>
        </div>
        `
      }

      function RandomPage() {
        return html`
        <div class="wrapper-inline">
          <header class="no-background">
            <div class="search-button" data-search="open">
              GPUX
            </div>
            <div class="navi-menu-button">
              <em></em>
              <em></em>
              <em></em>
            </div>
          </header>
          <main class="margin mt-0">
            <div class="dash-balance">
              <div class="d-flex align-items-center mt-30">
                <div class="d-flex flex-grow">
                  <div class="mr-auto">
                    <h1 class="b-val"> $2,589.50 </h1>
                    <p class="g-text mb-0">Total Balance</p>
                  </div>
                  <div class="ml-auto align-self-end">
                    <a href="profile.html" class="profile-av"><img src="img/content/avatar/avatar.png" /></a>
                  </div>
                </div>
              </div>
              <div class="services-bulk">
                <div class="content-row">
                  <div class="serv-item">
                    <a href="" class="serv-icon"><img src="img/content/icon1.png" class="mb-5" alt="" /></a>
                    <span>Send </span>
                  </div>
                  <div class="serv-item">
                    <a href="" class="serv-icon"><img src="img/content/icon2.png" class="mb-5" alt="" /></a>
                    <span>Recieve </span>
                  </div>
                  <div class="serv-item">
                    <a href="" class="serv-icon"><img src="img/content/icon4.png" class="mb-5" alt="" /></a>
                    <span>Loan </span>
                  </div>
                  <div class="serv-item">
                    <a href="" class="serv-icon"><img src="img/content/icon3.png" class="mb-5" alt="" /></a>
                    <span>Topup </span>
                  </div>
                </div>
              </div>
            </div>
            <footer>
              <div class="container">
                <ul>
                  <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                  <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                  <li><a href="#"><i class="fa fa-google"></i></a></li>
                  <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                </ul>
                <p>Copyright © All Right Reserved</p>
              </div>
            </footer>
          </main>
        </div>
        `
      }

      // postMessage(JSON.stringify({opcode: "HACK_move_wizard_slider", index: 1}))
      function WizardNewUser() {
        const fn_move_slider = function(e, index) {
          e.preventDefault();
          const slider_state = [...globalState.wizard_new_user.slider_state, index]
          setGlobalState({wizard_new_user: {slider_state: slider_state}})
          postMessage(JSON.stringify({opcode: "HACK_move_wizard_slider", index: index}));
          return false;
        }

        const fn_move_back = function(e) {
          e.preventDefault();
          var slider_state = [...globalState.wizard_new_user.slider_state];
          slider_state.pop()
          setGlobalState({wizard_new_user: {slider_state: slider_state}})
          postMessage(JSON.stringify({opcode: "HACK_move_wizard_slider", index: slider_state[slider_state.length-1]}));
          return false;
        }

        const fn_slider_to_wallet = function(e) {
          e.preventDefault();
          return false;
        }

        const fn_login_with_email = function(e) {
          e.preventDefault();
          return false;
        }

        /*
        0 welcome
        1 email/pkey
        2 email auth
        3 pkey gen/import
        4 pkey gen
        5 pkey import
        6 congradulation
        */

        return html`
        <div class="wrapper-inline">
          <main class="no-header wizard-page">
            <div class="wizard">
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard1.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3 class="onboard">Let’s get started</h3>
                  <p>We offer full custody or email based authentication.</p>
                  <div>
                    <a href="/initialize_wallet" class="more-btn" onClick=${e=> fn_move_slider(e, 1)}>
                      Create GPUX Account
                    </a>
                  </div>
                </div>
              </div>
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard2.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3>Almost There</h3>
                  <p>Choose your method of custody. (you can change later)</p>
                  <div><a href="/" class="more-btn" onClick=${e=> fn_move_slider(e, 2)}>✉️ Continue using Email</a></div>
                  <div>
                    <a href="/private_key" class="more-btn" onClick=${e=> fn_move_slider(e, 3)}>
                      🔐 Continue using Private Key
                    </a>
                  </div>
                </div>
              </div>
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard3.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3>Email Authentication</h3>
                  <p>No need to register just login and your account will be created.</p>
                  <div>
                    <a class="more-btn" style=${{padding: "0px", border: "0px", minWidth: "300px"}}>
                      <div class="form-row-group with-icons">
                        <div class="form-row no-padding" style=${{display: "-webkit-box"}}>
                          <i class="fa fa-envelope"></i>
                          <input type="email" class="form-element" placeholder="" />
                        </div>
                      </div>
                    </a>
                  </div>
                  <div>
                    <a class="more-btn" style=${{padding: "0px", border: "0px", minWidth: "300px"}}>
                      <div class="form-row-group with-icons">
                        <div class="form-row no-padding" style=${{display: "-webkit-box"}}>
                          <i class="fa fa-lock"></i>
                          <input type="password" class="form-element" placeholder="" />
                        </div>
                      </div>
                    </a>
                  </div>
                  <div><a href="/login_with_email" class="more-btn" onClick=${e=> fn_login_with_email(e)}>Continue</a></div>
                </div>
              </div>
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard3.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3>Setup Private Key</h3>
                  <P>Generate or import a new ED25519 private key.</p>
                  <div><a href="/generate_private_key" class="more-btn">🎲 Generate Private Key</a></div>
                  <div>
                    <a href="/import_private_key" class="more-btn" onClick=${e=> fn_move_slider(e, 7)}>
                      Import Private Key
                    </a>
                  </div>
                </div>
              </div>
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard3.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3>Import Private Key</h3>
                  <P>Paste your ED25519 private key in base58 or base64.</p>
                  <div>
                    <a class="more-btn" style=${{padding: "0px", border: "0px", minWidth: "300px"}}>
                      <div class="form-row no-padding">
                        <input type="text" class="form-element" placeholder="sfTh8uY4X3ppy1m.." />
                      </div>
                    </a>
                  </div>
                  <div><a href="/generate_private_key" class="more-btn">Confirm</a></div>
                </div>
              </div>
              <div class="wizard-item">
                <div class="wizard-content">
                  <div class="form-divider"></div>
                  <img src="img/content/onboard3.png" alt="" width="220" />
                  <div class="form-mini-divider"></div>
                  <h3>Congratulations!</h3>
                  <P>Your all set to create your first job.</p>
                  <div><a href="/learn_more" class="more-btn" onClick=${e=> {e.preventDefault(); fn_slider_to_wallet(); return false;}}>Learn More</a></div>
                  <div><a href="/to_wallet" class="more-btn" onClick=${e=> {e.preventDefault(); fn_slider_to_wallet(); return false;}}>
                    Take me to my Wallet</a>
                  </div>
                </div>
              </div>
            </div>
            ${
              globalState.wizard_new_user.slider_state.length == 1 ?
                html`<a class="wizard-skip-link" href="https://gpux.ai/">BACK TO GPUX</a>` :
                html`<a class="wizard-skip-link" href="/" onClick=${e=> fn_move_back(e)}>BACK</a>`
            }
          </main>
        </div>
        `
      }

      function Index() {
        const [s, hook_setGlobalState0] = useState(buildInitialState());
        wireUpGlobalState(s, hook_setGlobalState0);

        return html`
        <div class="wrapper">
          <${MenuSide} />
          <${WizardNewUser} />
        </div>
        `;
      }

      const MAP = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";
      function to_b58(term) {return (typeof term === 'string' || term instanceof String) ? to_b58_1(new TextEncoder().encode(term)) : to_b58_1(term)}
      function to_b58_1(B,A){if(!A){A=MAP};var d=[],s="",i,j,c,n;for(i in B){j=0,c=B[i];s+=c||s.length^i?"":1;while(j in d||c){n=d[j];n=n?n*256+c:c;c=n/58|0;d[j]=n%58;j++}}while(j--)s+=A[d[j]];return s};
      function from_b58(term) {return from_b58_1(term)}
      function from_b58_1(S,A){if(!A){A=MAP};var d=[],b=[],i,j,c,n;for(i in S){j=0,c=A.indexOf(S[i]);if(c<0)return undefined;c||b.length^i?i:b.push(0);while(j in d||c){n=d[j];n=n?n*58+c:c;c=n>>8;d[j]=n%256;j++}}while(j--)b.push(d[j]);return new Uint8Array(b)};

      function generate_random_keypair() {
        var sign_keypair = nacl.sign.keyPair();
        const pub_b58 = to_b58(sign_keypair.publicKey)
        const sec_b58 = to_b58(sign_keypair.secretKey)
        return [pub_b58, sec_b58]
      }

      function read_keypair() {
        var guest_seckey = localStorage.getItem("privkey:0");
        if (!guest_seckey) {
          return [null, null];
        } else {
          var guest_seckey = localStorage.getItem("privkey:0");
          var keyPair_ed = nacl.sign.keyPair.fromSecretKey(from_b58(guest_seckey))
          var pub_b58 = to_b58(keyPair_ed.publicKey)
          var sec_b58 = to_b58(keyPair_ed.secretKey)
          return [pub_b58, sec_b58]
        }
      }

      function init_seckey(force_refresh) {
        var [pub_b58, sec_b58] =  read_keypair()
        if (!pub_b58 || force_refresh) {
          var [pub_b58, sec_b58] = generate_random_keypair();
          localStorage.setItem("privkey:0", sec_b58);
          return [pub_b58, sec_b58]
        } else {
          return [pub_b58, sec_b58]
        }
      }

      async function load() {
        var [pub_b58, sec_b58] = read_keypair()
        if (pub_b58) {
          setInitialState({pub_b58: pub_b58, sec_b58: sec_b58});
        }
        ReactDOM.render(html`<${Index}/>`, document.getElementById("app"));
      }
      load();

    </script>
  </body>
</html>
